webpackJsonp([3],{"7iMY":function(t,a,e){"use strict";var n={name:"ElMessage",props:{value:{type:String,default:0},item:{type:String,default:""}},methods:{open:function(){var t=this;this.$prompt(this.item+"异常人数与总人数的占比","设置预警值",{inputValue:parseFloat(this.value),confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1-9]\d{0,1}$/,inputErrorMessage:"一百内整数"}).then(function(a){var e=a.value;t.$message({type:"success",message:t.item+"报警值已改为: "+e}),t.$emit("getMessage",e)}).catch(function(){t.$message({type:"info",message:"取消输入"})})}}},s={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"e-message"},[a("i",{staticClass:"iconfont edit",on:{click:this.open}},[this._v(" 设置警戒值")])])},staticRenderFns:[]};var i=e("VU/8")(n,s,!1,function(t){e("XeH1")},null,null);a.a=i.exports},PRe6:function(t,a){},XeH1:function(t,a){},a24X:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("Xxa5"),s=e.n(n),i=e("exGp"),r=e.n(i),o=e("K7jp"),l=e("eqMh"),u=e("5wXm"),c={name:"matts",props:{data:{type:Array,default:[{unit:"家",subText:"全市园所总数",sum:0},{unit:"人",subText:"园长总数",sum:0},{unit:"人",subText:"在职教师总数",sum:0},{unit:"万人",subText:"在园儿童总数",sum:0}]}},data:function(){return{}},mounted:function(){},methods:{}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"matts"},[e("ul",{staticClass:"list"},t._l(t.data,function(a,n){return e("li",{key:n},[e("span",[e("p",{staticClass:"num"},[e("i",[t._v(t._s(a.sum))]),t._v("\n          "+t._s(a.unit)+"\n        ")]),t._v(" "),e("p",{staticClass:"sub"},[t._v(t._s(a.subText))])])])}))])},staticRenderFns:[]};var m=e("VU/8")(c,d,!1,function(t){e("PRe6")},"data-v-b94b98ae",null).exports,g=e("TgKm"),f=e("CFpQ"),h=e("aCEB"),v=e("7iMY"),p={name:"HealthyToday",components:{ElMap:o.a,Bar:u.a,Matts:m,Pie:g.a,Live:l.a,ElMessage:v.a},data:function(){return{attendLoading:!0,loading:!0,warnPercent:{work:"30",temp:"30"},warn:{work:{show:!1,value:0},temp:{show:!1,value:0}},provinceId:localStorage.getItem("provinceId"),cityId:localStorage.getItem("cityId"),districtId:localStorage.getItem("districtId"),gardenName:localStorage.getItem("gardenName"),gardenId:localStorage.getItem("gardenId"),tagInfoData:[],gardenRecord:{name:"拱墅区植材小学",location:"拱墅区"},attendance:{xData:["暂无数据"],maxVal:10,data:["0"],linearGradient:["#53e9ee","#325fff"],hasLine:!0,labelHide:!0,labelNuit:"{c}%",yName:"百分比(%)",grid:{top:"20%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},temperature:{xData:["暂无数据"],data:["0"],maxVal:20,linearGradient:["#ff9786","#ffe98f"],labelHide:!0,hasLine:!0,yName:"人数（人）",grid:{top:"20%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},tempSettings:{xData:["体温正常","体温偏高"],data:[0,0],linearGradient:["#ffe98f","#2dffff"],maxVal:70,yHide:!0,labelHide:!0,grid:{top:"5%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},snacksSettings:{xData:["需要加餐","需要服药","需要观察"],data:[0,0,0],linearGradient:["#2de7ff","#ff6dff"],maxVal:70,yHide:!0,labelHide:!0,grid:{top:"5%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},workData:[{unit:"人",subText:"已出勤人数",sum:0},{unit:"人",subText:"请假人数",sum:0},{unit:"人",subText:"预估缺勤人数",sum:0}],KindergartenData:[{unit:"家",subText:"园所总数",sum:0},{unit:"人",subText:"园长总数",sum:0},{unit:"人",subText:"在职教师总数",sum:0},{unit:"人",subText:"在园儿童总数",sum:0}],jobData:{data:[{value:0,name:"正高级"},{value:0,name:"高级"},{value:0,name:"一级"},{value:0,name:"二级"},{value:0,name:"三级"}],color:["#ffbc00","#57d0ff","#4d6bff","#ff6562","#9d70ff"],title:"职称分布",pieSize:{radius:["35%","45%"],center:["50%","35%"],title:{top:52,fontSize:12}}},ageData:{data:[{value:0,name:"00后"},{value:0,name:"90后"},{value:0,name:"80后"},{value:0,name:"70后"}],color:["#1683fb","#61ffe1","#24cbff","#7189ff"],title:"年龄分布",pieSize:{radius:["35%","45%"],center:["50%","35%"],title:{top:52,fontSize:12}}}}},mounted:function(){var t=this;localStorage.getItem("workVal")&&(this.warnPercent.work=localStorage.getItem("workVal")),localStorage.getItem("tempVal")&&(this.warnPercent.temp=localStorage.getItem("tempVal")),this.$common.border(window.$(".bottom .content")),setInterval(function(){t.refresh()},3e5),this.getAttendCount(),this.getGardenInfos(),this.getAttendRage()},methods:{getMessage:function(t,a){switch(a){case"work":this.warnPercent.work=t[0],localStorage.setItem("workVal",t[0]);break;case"temp":this.warnPercent.temp=t[0],localStorage.setItem("tempVal",t[0])}this.refresh()},refresh:function(){window.$(".refresh").find("i").addClass("loading"),this.getAttendCount(),this.getGardenInfos(),this.getAttendRage()},getAttendCount:function(){var t=r()(s.a.mark(function t(){var a,e,n,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get(h.a.attendGarden,{gardenId:this.gardenId});case 2:a=t.sent,e=a.data.data,n=e.leaveCount/e.totalCount*100>=parseFloat(this.warnPercent.work),this.warn.work=n?{show:!0,value:(e.leaveCount/e.totalCount*100-parseFloat(this.warnPercent.work)).toFixed(2)}:{show:!1,value:(e.leaveCount/e.totalCount*100-parseFloat(this.warnPercent.work)).toFixed(2)},i=(e.gcCount+e.fyCount)/e.totalCount*100>=parseFloat(this.warnPercent.temp),this.warn.temp=i?{show:!0,value:((e.gcCount+e.fyCount)/e.totalCount*100-parseFloat(this.warnPercent.temp)).toFixed(2)}:{show:!1,value:((e.gcCount+e.fyCount)/e.totalCount*100-parseFloat(this.warnPercent.temp)).toFixed(2)},this.workData[0].sum=e.attendCount,this.workData[1].sum=e.leaveCount,this.workData[2].sum=e.totalCount-e.attendCount,this.tempSettings.data=[e.normalTempCount,e.warnTempCount],this.snacksSettings.data=[e.jcCount,e.fyCount,e.gcCount];case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getGardenInfos:function(){var t=r()(s.a.mark(function t(){var a,e,n,i,r,o,l,u,c=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get(h.a.getGardenInfos,{gardenId:this.gardenId});case 2:if(a=t.sent,e=a.data.data,console.log(e,"123123123123123123123"),this.KindergartenData[0].sum=e.gardenCount,this.KindergartenData[1].sum=e.kindergartenCount,this.KindergartenData[2].sum=e.teacherCount,this.KindergartenData[3].sum=e.totalCount,n=["00","90","80","70"],i=["正高级","高级","一级","二级","三级"],this.jobData.data=[{value:0,name:"正高级"},{value:0,name:"高级"},{value:0,name:"一级"},{value:0,name:"二级"},{value:0,name:"三级"}],this.ageData.data=[{value:0,name:"00后"},{value:0,name:"90后"},{value:0,name:"80后"},{value:0,name:"70后"}],e.jobs.length)for(r=function(t,a){var n=e.jobs.filter(function(a){return a.item1===i[t]});n.length?c.jobData.data[t].value=n[0].item2:c.jobData.data[t].value=0},o=0,l=this.jobData.data.length;o<l;o++)r(o,l);else this.jobData.data=[{name:"暂无数据",value:0}];if(e.ages.length)for(u=function(t,a){var s=e.ages.filter(function(a){return a.item1.substring(0,1)===n[t].substring(0,1)});s.length?c.ageData.data[t].value=s.length:c.ageData.data[t].value=0},o=0,l=this.ageData.data.length;o<l;o++)u(o,l);else this.ageData.data=[{name:"暂无数据",value:0}];case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getAttendRage:function(){var t=r()(s.a.mark(function t(){var a,e,n,i,r,o,l,u,c,d,m,g,v,p,C,w,b;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.get(h.a.getAttendRages,{gardenId:this.gardenId});case 2:if(a=t.sent,(e=a.data.data).length){for(this.attendLoading=!1,window.$(".refresh").find("i").removeClass("loading"),n={totalCount:0,attendCount:0,warnCount:0,jcCount:0,fyCount:0,gcCount:0},i=0;i<e.length;i++)e[i]=window.$.extend({},n,e[i]);for(r=0,o=e.length;r<o;r++)1===e[r].gradeNum?e[r].name="托班":2===e[r].gradeNum?e[r].name="小班":3===e[r].gradeNum?e[r].name="中班":4===e[r].gradeNum&&(e[r].name="大班");for(l=0,u=e.length;l<u;l++)e[l].rate=(e[l].attendCount/e[l].totalCount*100).toFixed(2);if((c=e.filter(function(t){return t.name&&0!==t.attendCount})).length){for((d={attend:c,temperature:c}).attend.sort(function(t,a){return a.rate-t.rate}),m=[],g=[],v=0,p=d.attend.length;v<p;v++)m.push(d.attend[v].name),g.push(d.attend[v].rate);for(this.attendance.xData=m,this.attendance.data=g,this.attendance.maxVal=Math.max.apply(Math,g),console.log(m,g),d.temperature.sort(function(t,a){return a.warnCount-t.warnCount}),C=[],w=[],b=0;b<d.temperature.length;b++)C.push(d.temperature[b].name),w.push(d.temperature[b].warnCount);this.temperature.xData=C,this.temperature.data=w,this.temperature.maxVal=Math.max.apply(Math,w)}else this.temperature.xData=["暂无数据"],this.temperature.data=["0"],this.attendance.data=["0"],this.attendance.xData=["暂无数据"]}else this.temperature.xData=["暂无数据"],this.temperature.data=["0"],this.attendance.data=["0"],this.attendance.xData=["暂无数据"];case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},C={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main-box"},[e("div",{staticClass:"main"},[e("div",{staticClass:"middle"},[e("div",{staticClass:"left"},[e("live",{attrs:{name:t.gardenRecord.name}})],1),t._v(" "),e("div",{staticClass:"right"},[e("p",{staticClass:"refresh"},[t._v("数据每隔五分钟自动刷新\n          "),e("button",{staticClass:"btn1",on:{click:t.refresh}},[e("i",{staticClass:"iconfont"},[t._v("")]),t._v("刷新")])]),t._v(" "),e("ul",{staticClass:"ranking"},[e("li",[t._m(0),t._v(" "),e("div",{staticClass:"content"},["暂无数据"===t.attendance.xData[0]||-1===t.attendance.data.findIndex(function(t){return 0!==t})?e("no-data",{attrs:{item:"出勤",bg:!0}}):e("bar",{attrs:{settings:t.attendance}})],1)]),t._v(" "),e("li",[t._m(1),t._v(" "),e("div",{staticClass:"content"},["暂无数据"===t.temperature.xData[0]||-1===t.temperature.data.findIndex(function(t){return 0!==t})?e("no-data",{attrs:{item:"体温",bg:!0}}):e("bar",{attrs:{settings:t.temperature}})],1)])])])]),t._v(" "),e("div",{staticClass:"line"}),t._v(" "),e("div",{staticClass:"bottom"},[e("ul",{staticClass:"statistics"},[e("li",{staticClass:"warn-box"},[e("div",{staticClass:"title-box"},[e("h3",{staticClass:"title"},[e("em"),t._v("\n              今日出勤统计\n              "),e("i",{staticClass:"percent"},[t._v("请假预警值"+t._s(t.warnPercent.work)+"%")])]),t._v(" "),e("el-message",{attrs:{value:t.warnPercent.work,item:"请假"},on:{getMessage:function(a){t.getMessage(arguments,"work")}}})],1),t._v(" "),e("div",{staticClass:"content"},[t.warn.work.show?e("p",{staticClass:"warn"},[e("i",{staticClass:"iconfont",staticStyle:{"margin-left":"25px"}},[t._v("")]),t._v("\n              请假预警，超警戒值"+t._s(t.warn.work.value)+"%\n            ")]):t._e(),t._v(" "),e("matts",{directives:[{name:"loading",rawName:"v-loading",value:t.attendLoading,expression:"attendLoading"}],attrs:{data:t.workData,"element-loading-background":"rgba(0, 0, 0, 0)"}})],1)]),t._v(" "),e("li",{staticClass:"warn-box"},[e("div",{staticClass:"title-box"},[e("h3",{staticClass:"title"},[e("em"),t._v("\n              今日晨检统计\n              "),e("i",{staticClass:"percent"},[t._v("疾病预警值"+t._s(t.warnPercent.temp)+"%")])]),t._v(" "),e("el-message",{attrs:{value:t.warnPercent.temp,item:"体温"},on:{getMessage:function(a){t.getMessage(arguments,"temp")}}})],1),t._v(" "),e("div",{staticClass:"content"},[t.warn.temp.show?e("p",{staticClass:"warn"},[e("i",{staticClass:"iconfont",staticStyle:{"margin-left":"17px"}},[t._v("")]),t._v("\n              疾病预警，超警戒值"+t._s(t.warn.temp.value)+"%\n            ")]):t._e(),t._v(" "),-1!==t.tempSettings.data.findIndex(function(t){return 0!==t})?e("ul",{directives:[{name:"loading",rawName:"v-loading",value:t.attendLoading,expression:"attendLoading"}],staticClass:"echarts-box",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[e("li",[e("bar",{attrs:{settings:t.tempSettings}})],1),t._v(" "),e("li",[e("bar",{attrs:{settings:t.snacksSettings}})],1)]):e("no-data",{attrs:{item:"晨检统计"}})],1)]),t._v(" "),e("li",[t._m(2),t._v(" "),e("div",{staticClass:"content"},[e("matts",{attrs:{data:t.KindergartenData}})],1)]),t._v(" "),e("li",[t._m(3),t._v(" "),e("ul",{staticClass:"content"},[e("li",["暂无数据"!==t.jobData.data[0].name?e("pie",{attrs:{data:t.jobData.data,color:t.jobData.color,title:t.jobData.title,pieSize:t.jobData.pieSize}}):e("no-data",{attrs:{item:"职称"}})],1),t._v(" "),e("li",["暂无数据"!==t.ageData.data[0].name?e("pie",{attrs:{data:t.ageData.data,color:t.ageData.color,title:t.ageData.title,pieSize:t.ageData.pieSize}}):e("no-data",{attrs:{item:"年龄"}})],1)])])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("以出勤记录情况排名")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("以体温报警人数排名")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("幼儿园信息")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("教师信息")])}]};var w=e("VU/8")(p,C,!1,function(t){e("iU3D")},"data-v-9b0112d8",null);a.default=w.exports},iU3D:function(t,a){}});
//# sourceMappingURL=3.d4c33ac5799dac44a849.js.map