webpackJsonp([4],{"7iMY":function(t,a,e){"use strict";var n={name:"ElMessage",props:{value:{type:String,default:0},item:{type:String,default:""}},methods:{open:function(){var t=this;this.$prompt(this.item+"异常人数与总人数的占比","设置预警值",{inputValue:parseFloat(this.value),confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[1-9]\d{0,1}$/,inputErrorMessage:"一百内整数"}).then(function(a){var e=a.value;t.$message({type:"success",message:t.item+"报警值已改为: "+e}),t.$emit("getMessage",e)}).catch(function(){t.$message({type:"info",message:"取消输入"})})}}},s={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"e-message"},[a("i",{staticClass:"iconfont edit",on:{click:this.open}},[this._v(" 设置警戒值")])])},staticRenderFns:[]};var r=e("VU/8")(n,s,!1,function(t){e("XeH1")},null,null);a.a=r.exports},XeH1:function(t,a){},bBFM:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("Xxa5"),s=e.n(n),r=e("exGp"),i=e.n(r),o=e("K7jp"),l=e("eqMh"),c=e("5wXm"),u=e("lZmn"),d=e("TgKm"),m=e("CFpQ"),v=e("aCEB"),f=e("7iMY"),g={name:"HealthyToday",components:{ElMap:o.a,Bar:c.a,Matts:u.a,Pie:d.a,Live:l.a,ElMessage:f.a},data:function(){return{rankLoading:!0,loading:!0,warnPercent:{work:"30",temp:"30"},warn:{work:{show:!1,value:0},temp:{show:!1,value:0}},tagInfoData:{name:"健康安全",data:[]},attendance:{xData:["暂无数据"],data:[0,0,0,0,0,0,0,0,0,0,0,0,0],linearGradient:["#53e9ee","#325fff"],hasLine:!0,yName:"人数（人）",grid:{top:"20%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},temperature:{xData:["暂无数据"],data:[0,0,0,0,0,0,0,0,0,0,0,0,0],linearGradient:["#ff9786","#ffe98f"],hasLine:!0,yName:"人数（人）",grid:{top:"20%",left:"0%",right:"0%",bottom:"10%",containLabel:!0}},tempSettings:{xData:["体温正常","体温偏高"],data:[0,0],linearGradient:["#ffe98f","#2dffff"],maxVal:70,yHide:!0,labelHide:!0,grid:{top:"5%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},snacksSettings:{xData:["需要加餐","需要服药","需要观察"],data:[0,0,0],linearGradient:["#2de7ff","#ff6dff"],maxVal:70,yHide:!0,labelHide:!0,grid:{top:"5%",left:"0%",right:"0%",bottom:"0%",containLabel:!0}},workData:[{unit:"人",subText:"已出勤人数",sum:0},{unit:"人",subText:"请假人数",sum:0},{unit:"人",subText:"预估缺勤人数",sum:0}],KindergartenData:[{unit:"家",subText:"园所总数",sum:0},{unit:"人",subText:"园长总数",sum:0},{unit:"人",subText:"在职教师总数",sum:0},{unit:"人",subText:"在园儿童总数",sum:0}],jobData:{data:[{value:0,name:"正高级"},{value:0,name:"高级"},{value:0,name:"一级"},{value:0,name:"二级"},{value:0,name:"三级"}],color:["#ffbc00","#57d0ff","#4d6bff","#ff6562","#9d70ff"],title:"职称分布",pieSize:{radius:["35%","45%"],center:["50%","35%"],title:{top:52,fontSize:12}}},ageData:{data:[{value:0,name:"00后"},{value:0,name:"90后"},{value:0,name:"80后"},{value:0,name:"70后"}],color:["#1683fb","#61ffe1","#24cbff","#7189ff"],title:"年龄分布",pieSize:{radius:["35%","45%"],center:["50%","35%"],title:{top:52,fontSize:12}}}}},methods:{getMessage:function(t,a){switch(a){case"work":this.warnPercent.work=t[0],localStorage.setItem("workVal",t[0]);break;case"temp":this.warnPercent.temp=t[0],localStorage.setItem("tempVal",t[0])}this.$refs.map.tagInfoRefresh(),this.refresh()},refresh:function(){window.$(".refresh").find("i").addClass("loading"),this.loading=!0,console.log(this.$store.state.mapArea.level);var t={level:this.$store.state.mapArea.level,name:this.$store.state.mapArea.name};this.mapObiterData(t)},generalData:function(t){var a=this;this.KindergartenData[0].sum=t.gardenCount,this.KindergartenData[1].sum=t.kindergartenCount,this.KindergartenData[2].sum=t.teacherCount,this.KindergartenData[3].sum=t.totalCount;var e=["00","90","80","70"],n=["正高级","高级","一级","二级","三级"];if(this.jobData.data=[{value:0,name:"正高级"},{value:0,name:"高级"},{value:0,name:"一级"},{value:0,name:"二级"},{value:0,name:"三级"}],this.ageData.data=[{value:0,name:"00后"},{value:0,name:"90后"},{value:0,name:"80后"},{value:0,name:"70后"}],t.jobs.length)for(var s=function(e,s){var r=t.jobs.filter(function(t){return t.item1===n[e]});r.length?a.jobData.data[e].value=r[0].item2:a.jobData.data[e].value=0},r=0,i=n.length;r<i;r++)s(r);else this.jobData.data=[{name:"暂无数据",value:0}];if(t.ages.length){var o=function(n,s){var r=t.ages.filter(function(t){return t.item1.substring(0,1)===e[n].substring(0,1)});r.length?a.ageData.data[n].value=r.length:a.ageData.data[n].value=0};for(r=0,i=e.length;r<i;r++)o(r)}else this.ageData.data=[{name:"暂无数据",value:0}]},mapObiterData:function(t){var a=t.name;switch(t.level){case"省级":this.overview("provinceName",a),this.provinceData(a);break;case"市级":this.overview("cityName",a),this.cityData(a);break;case"县级":this.overview("districtName",a),this.districtData(a);break;case"园所级":var e=this.gardenList().filter(function(t){return t.name===a});this.overview("gardenId",e[0].gardenId)}},gardenList:function(){return[{name:"宝塔区双睿幼儿园",gardenId:1}]},overview:function(){var t=i()(s.a.mark(function t(a,e){var n,r,i,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=void 0,t.t0=a,t.next="provinceName"===t.t0?4:"cityName"===t.t0?8:"districtName"===t.t0?12:"gardenId"===t.t0?16:19;break;case 4:return t.next=6,m.a.get(v.a.attendOverview,{provinceName:e});case 6:return n=t.sent,t.abrupt("break",19);case 8:return t.next=10,m.a.get(v.a.attendOverview,{cityName:e});case 10:return n=t.sent,t.abrupt("break",19);case 12:return t.next=14,m.a.get(v.a.attendOverview,{districtName:e});case 14:return n=t.sent,t.abrupt("break",19);case 16:return t.next=18,m.a.get(v.a.attendOverview,{gardenId:e});case 18:n=t.sent;case 19:n.data&&(window.$(".refresh").find("i").removeClass("loading"),this.loading=!1,r=n.data.data,console.log("当前区域总览数据（出勤，晨检）"),console.log(r),i=r.leaveCount/r.totalCount*100>=parseFloat(this.warnPercent.work),this.warn.work=i?{show:!0,value:(r.leaveCount/r.totalCount*100-parseFloat(this.warnPercent.work)).toFixed(2)}:{show:!1,value:(r.leaveCount/r.totalCount*100-parseFloat(this.warnPercent.work)).toFixed(2)},o=(r.gcCount+r.fyCount)/r.totalCount*100>=parseFloat(this.warnPercent.temp),this.warn.temp=o?{show:!0,value:((r.gcCount+r.fyCount)/r.totalCount*100-parseFloat(this.warnPercent.temp)).toFixed(2)}:{show:!1,value:((r.gcCount+r.fyCount)/r.totalCount*100-parseFloat(this.warnPercent.temp)).toFixed(2)},this.workData[0].sum=r.attendCount,this.workData[1].sum=r.leaveCount,this.workData[2].sum=r.totalCount-r.attendCount,this.tempSettings.data=[r.normalTempCount,r.warnTempCount],this.snacksSettings.data=[r.jcCount,r.fyCount,r.gcCount]);case 20:case"end":return t.stop()}},t,this)}));return function(a,e){return t.apply(this,arguments)}}(),provinceData:function(){var t=i()(s.a.mark(function t(a){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get(v.a.province,{provinceName:a});case 2:(e=t.sent).data&&this.tagInfo(e.data.data);case 4:case"end":return t.stop()}},t,this)}));return function(a){return t.apply(this,arguments)}}(),cityData:function(){var t=i()(s.a.mark(function t(a){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get(v.a.city,{cityName:a});case 2:(e=t.sent).data&&this.tagInfo(e.data.data);case 4:case"end":return t.stop()}},t,this)}));return function(a){return t.apply(this,arguments)}}(),districtData:function(){var t=i()(s.a.mark(function t(a){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get(v.a.district,{districtName:a});case 2:(e=t.sent).data&&this.tagInfo(e.data.data);case 4:case"end":return t.stop()}},t,this)}));return function(a){return t.apply(this,arguments)}}(),tagInfo:function(t){for(var a=this,e={warnCount:0,jcCount:0,fyCount:0,gcCount:0,attendCount:0,totalCount:0,leaveCount:0},n=0,s=t.length;n<s;n++)t[n]=window.$.extend({},e,t[n]);for(var r=[],i=function(e,n){var s=t.filter(function(t){return t.cityName===a.$store.state.mapArea.list[e]||t.districtName===a.$store.state.mapArea.list[e]||t.gardenName===a.$store.state.mapArea.list[e]});s.length?r.push(s[0]):r.push({cityName:a.$store.state.mapArea.list[e],districtName:a.$store.state.mapArea.list[e],gardenName:a.$store.state.mapArea.list[e],warnCount:0,jcCount:0,fyCount:0,gcCount:0,attendCount:0,totalCount:0,leaveCount:0})},o=0,l=this.$store.state.mapArea.list.length;o<l;o++)i(o);t=r,console.log("当前区域所有下级总览信息（出勤，晨检）"),console.log(t),this.tagInfoData.data=t;var c={xData:[],data:[]},u={xData:[],data:[]},d="";switch(this.$store.state.mapArea.level){case"省级":d="cityName";break;case"市级":d="districtName";break;case"县级":d="gardenName"}for(var m=this.$common.compareSort(t,"attendCount"),v=0,f=m.length;v<f;v++)c.xData.push(m[v][d]),c.data.push(m[v].attendCount);this.attendance.xData=c.xData,this.attendance.data=c.data;for(var g=this.$common.compareSort(t,"warnCount"),h=0,p=g.length;h<p;h++)u.xData.push(g[h][d]),u.data.push(g[h].warnCount);this.temperature.xData=u.xData,this.temperature.data=u.data,this.rankLoading=!1}},mounted:function(){var t=this;localStorage.getItem("workVal")&&(this.warnPercent.work=localStorage.getItem("workVal")),localStorage.getItem("tempVal")&&(this.warnPercent.temp=localStorage.getItem("tempVal")),this.$common.border(window.$(".bottom .content")),setInterval(function(){t.refresh()},3e5)}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main-box"},[e("div",{staticClass:"main"},[e("div",{staticClass:"middle"},[e("div",{staticClass:"left"},[e("el-map",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"map",attrs:{tagInfoData:t.tagInfoData,warnPercent:t.warnPercent,"element-loading-background":"rgba(0, 0, 0, 0)"},on:{mapObiterData:t.mapObiterData,generalData:t.generalData}})],1),t._v(" "),e("div",{staticClass:"right"},[e("p",{staticClass:"refresh"},[t._v("数据每隔五分钟自动刷新"),e("button",{staticClass:"btn1",on:{click:t.refresh}},[e("i",{staticClass:"iconfont"},[t._v("")]),t._v("刷新")])]),t._v(" "),e("ul",{staticClass:"ranking"},[e("li",[t._m(0),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.rankLoading,expression:"rankLoading"}],staticClass:"content",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[-1!==t.attendance.data.findIndex(function(t){return 0!==t})?e("bar",{attrs:{settings:t.attendance}}):e("no-data",{attrs:{item:"出勤",bg:!0}})],1)]),t._v(" "),e("li",[t._m(1),t._v(" "),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.rankLoading,expression:"rankLoading"}],staticClass:"content",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[-1!==t.temperature.data.findIndex(function(t){return 0!==t})?e("bar",{attrs:{settings:t.temperature}}):e("no-data",{attrs:{item:"体温",bg:!0}})],1)])])])]),t._v(" "),e("div",{staticClass:"line"}),t._v(" "),e("div",{staticClass:"bottom"},[e("ul",{staticClass:"statistics"},[e("li",{staticClass:"warn-box"},[e("div",{staticClass:"title-box"},[e("h3",{staticClass:"title"},[e("em"),t._v("\n              今日出勤统计\n              "),e("i",{staticClass:"percent"},[t._v("请假预警值"+t._s(t.warnPercent.work)+"%")])]),t._v(" "),e("el-message",{attrs:{value:t.warnPercent.work,item:"请假"},on:{getMessage:function(a){t.getMessage(arguments,"work")}}})],1),t._v(" "),e("div",{staticClass:"content"},[t.warn.work.show?e("p",{staticClass:"warn"},[e("i",{staticClass:"iconfont",staticStyle:{"margin-left":"25px"}},[t._v("")]),t._v("\n              请假预警，超警戒值"+t._s(t.warn.work.value)+"%\n            ")]):t._e(),t._v(" "),e("matts",{attrs:{data:t.workData}})],1)]),t._v(" "),e("li",{staticClass:"warn-box"},[e("div",{staticClass:"title-box"},[e("h3",{staticClass:"title"},[e("em"),t._v("\n              今日晨检统计\n              "),e("i",{staticClass:"percent"},[t._v("疾病预警值"+t._s(t.warnPercent.temp)+"%")])]),t._v(" "),e("el-message",{attrs:{value:t.warnPercent.temp,item:"体温"},on:{getMessage:function(a){t.getMessage(arguments,"temp")}}})],1),t._v(" "),e("div",{staticClass:"content"},[t.warn.temp.show?e("p",{staticClass:"warn"},[e("i",{staticClass:"iconfont",staticStyle:{"margin-left":"17px"}},[t._v("")]),t._v("\n              疾病预警，超警戒值"+t._s(t.warn.temp.value)+"%\n            ")]):t._e(),t._v(" "),-1!==t.tempSettings.data.findIndex(function(t){return 0!==t})?e("ul",{staticClass:"echarts-box"},[e("li",[e("bar",{attrs:{settings:t.tempSettings}})],1),t._v(" "),e("li",[e("bar",{attrs:{settings:t.snacksSettings}})],1)]):e("no-data",{attrs:{item:"晨检统计"}})],1)]),t._v(" "),e("li",[t._m(2),t._v(" "),e("div",{staticClass:"content"},[e("matts",{attrs:{data:t.KindergartenData}})],1)]),t._v(" "),e("li",[t._m(3),t._v(" "),e("ul",{staticClass:"content"},[e("li",["暂无数据"!==t.jobData.data[0].name?e("pie",{attrs:{data:t.jobData.data,color:t.jobData.color,title:t.jobData.title,pieSize:t.jobData.pieSize}}):e("no-data",{attrs:{item:"职称"}})],1),t._v(" "),e("li",["暂无数据"!==t.ageData.data[0].name?e("pie",{attrs:{data:t.ageData.data,color:t.ageData.color,title:t.ageData.title,pieSize:t.ageData.pieSize}}):e("no-data",{attrs:{item:"年龄"}})],1)])])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("以出勤记录情况排名")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("以体温报警人数排名")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("幼儿园信息")])},function(){var t=this.$createElement,a=this._self._c||t;return a("h3",{staticClass:"title"},[a("em"),this._v("教师信息")])}]};var p=e("VU/8")(g,h,!1,function(t){e("dQ/v")},"data-v-01fa3b37",null);a.default=p.exports},"dQ/v":function(t,a){}});
//# sourceMappingURL=4.d851879ebc2114e4d8e0.js.map